---
layout: "post"
title:  "github多账户相关"
date:   "2023-12-05 00:00:00 +0800"
categories: "github git Q&A"
---
{% include toc.md %}

## github多账户问题处理

我在一台windows电脑上同时使用了两个github账户（非SSH方式）。发现会遇到几个问题，来回折腾了好一阵,记录下最后的解决方案。

### 问题 1 提交记录里user.name会混

这个简单，区分好全局配置和当前仓库配置，按需设置。  
或者直接取消全局配置，每个仓库都单独设置一次。

*一些常用命令*

```bash
git config --global user.name "Your Name"
git config --global user.email "your.email@example.com"
```

```bash
git config user.name "Your Name"
git config user.email "your.email@example.com"
```

```bash
git config --unset --global user.name
git config --unset --global user.email
```

```bash
git config --unset user.name
git config --unset user.email
```

### 问题 2 权限会失灵，某个账户会无法进行推拉操作

**最后是使用了SSH方式。**

git常用方式是IDEA插件自带的github账户登录模块，clone地址用https方式。

- 换成token登录方式不行
- 换成设备码登录方式不行
- 尝试了几个配置项调整方案，没有完全解决问题，也可能折腾过程中反复改没配置好。  
  比如这个认证器相关

```bash
  git config --global credential.helper store
```

- 有一个方案是 在https的remote地址中加入token明文，不想用。

#### SSH方案

给两个账号分别生成SSH key，分别添加到各种github账号上，本地多设置一个ssh的config文件指引不同的仓库对应不同ssh配置。

- 在本地生成SSH key。

```bash
ssh-keygen -t rsa -C "aaa.email@example.com"
ssh-keygen -t rsa -C "bbb.email@example.com"
```

```bash
ssh-add ~/.ssh/id_rsa_aaa
ssh-add ~/.ssh/id_rsa_bbb
```

- 将SSH公钥添加到各自的github账号中。

- 配置SSH本地config文件，修改或新建。windows在C:\Users\{用户名}\.ssh

```bash
# host是跟clone的仓库remote地址对应
# aaa.email@example.com account 这个相当于默认配置
Host github.com
  HostName github.com
  User aaa
  PreferredAuthentications publickey
  IdentityFile "id_rsa_aaa"


# bbb.email@example.com account 这个可以根据对应的remote地址匹配到
Host bbb.github.com
  HostName github.com
  User bbb
  PreferredAuthentications publickey
  IdentityFile "id_rsa_bbb"
```

- 测试SSH是否配置成功。成功了是能看到对应账号名字返回的。

```bash
ssh -T git@github.com
ssh -T git@bbb.github.com
```

- clone项目或管理ssh远程仓库地址时，地址中补充上对应的账号域名可以生效指定的ssh配置。不补充就是默认github.com配置

```bash
#会使用 github.com 的默认ssh配置
git@github.com:aaa/projecta.git
#会使用 bbb.github.com 的ssh配置
git@bbb.github.com:bbb/projectb.git
```

---
